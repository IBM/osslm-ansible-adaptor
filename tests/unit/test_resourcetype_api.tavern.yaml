test_name: resource type API

stages:
  - name: Get all resource types
    request:
      url: "{tavern.env_vars.ARM_URL}types"
      method: GET
    response:
      status_code: 200
      json:
        - name: "resource::hello-world::1.0"
          state: "PUBLISHED"
        - name: "resource::openstack-network::1.0"
          state: "PUBLISHED"

  - name: Get resource type details by name
    request:
      url: "{tavern.env_vars.ARM_URL}types/resource::hello-world::1.0"
      method: GET
    response:
      status_code: 200
      json:
        name: "resource::hello-world::1.0"
        state: "PUBLISHED"
        descriptor: !anystr

  - name: Get resource type details by name, not found, wrong version
    request:
      url: "{tavern.env_vars.ARM_URL}types/resource::hello-world::1.1"
      method: GET
    response:
      status_code: 404
      json:
        detail: "resource type version 1.1 not found"
        status: 404
        title: "Not Found"
        type: "about:blank"


  - name: Get resource type details by name, not found, wrong name
    request:
      url: "{tavern.env_vars.ARM_URL}types/resource::hello-worlds::1.0"
      method: GET
    response:
      status_code: 404
      json:
        detail: "resource type hello-worlds not found"
        status: 404
        title: "Not Found"
        type: "about:blank"

  - name: Get resource type details by name, not found, wrong format
    request:
      url: "{tavern.env_vars.ARM_URL}types/resource::hello-world:1.0"
      method: GET
    response:
      status_code: 404
      json:
        detail: "resource type resource::hello-world:1.0 not found. Invalid format. Should be resource::name::version"
        status: 404
        title: "Not Found"
        type: "about:blank"